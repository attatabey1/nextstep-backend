{% extends "base.html" %}
{% load i18n %}

{% block title %}{% trans "Browse Opportunities" %} â€¢ SCHOLARIFY{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="relative bg-gradient-to-br from-primary-50/30 via-white to-secondary-50/20">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-8 pb-6">
    <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6">
      <div class="flex-1">
        <!-- Breadcrumb -->
        <nav class="mb-4" aria-label="Breadcrumb">
          <ol class="flex items-center space-x-2 text-sm text-slate-600">
            <li>
              <a href="/" class="hover:text-primary-600 transition-colors">{% trans "Home" %}</a>
            </li>
            <li class="flex items-center">
              <i class="fas fa-chevron-right mx-2 text-xs text-slate-400"></i>
            </li>
            <li class="text-primary-700 font-semibold" aria-current="page">
              {% trans "Browse Opportunities" %}
            </li>
          </ol>
        </nav>

        <!-- Title -->
        <h1 class="text-3xl sm:text-4xl lg:text-5xl font-black tracking-tight text-slate-900 leading-tight">
          {% trans "Find Your Next" %}
          <span class="gradient-text">{% trans "Opportunity" %}</span>
        </h1>
        
        <p class="mt-3 text-lg text-slate-600 max-w-2xl">
          {% trans "Discover jobs, scholarships, and courses worldwide. Filter by location, type, and deadline to find the perfect match." %}
        </p>

        <!-- Quick Stats -->
        {% if page_obj %}
        <div class="mt-6 flex items-center gap-6">
          <div class="flex items-center gap-2">
            <div class="h-3 w-3 rounded-full bg-primary-500 animate-pulse"></div>
            <div class="text-sm text-slate-700">
              <span class="font-bold text-slate-900">{{ page_obj.paginator.count }}</span>
              {% trans "opportunities available" %}
            </div>
          </div>
          
          <div class="hidden sm:flex items-center gap-2">
            <i class="fas fa-filter text-primary-500 text-sm"></i>
            <div class="text-sm text-slate-700">
              <span class="font-bold text-slate-900">{{ filters_active }}</span>
              {% trans "active filters" %}
            </div>
          </div>
        </div>
        {% endif %}
      </div>

      <!-- Results Counter -->
      {% if page_obj %}
      <div class="bg-white rounded-2xl border border-slate-200 p-4 lg:p-6 shadow-sm">
        <div class="text-center">
          <div class="text-2xl lg:text-3xl font-bold text-slate-900 mb-1">{{ page_obj.start_index }}-{{ page_obj.end_index }}</div>
          <div class="text-xs text-slate-600 uppercase tracking-wider font-semibold">{% trans "Showing" %}</div>
          <div class="text-sm text-slate-500 mt-2">{% trans "of" %} {{ page_obj.paginator.count }} {% trans "total" %}</div>
        </div>
      </div>
      {% endif %}
    </div>
  </div>
</section>

<!-- Advanced Filters -->
<section class="sticky top-20 z-30 bg-white/95 backdrop-blur-sm border-b border-slate-200 shadow-sm">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
    <div class="bg-white rounded-2xl border border-slate-200 shadow-lg p-4 lg:p-6">
      <div class="flex items-center justify-between mb-4">
        <div class="flex items-center gap-2">
          <i class="fas fa-sliders-h text-primary-600"></i>
          <h2 class="text-lg font-bold text-slate-900">{% trans "Filter Opportunities" %}</h2>
        </div>
        
        {% if filters_active %}
        <a href="{% url 'listings_list' %}" 
           class="text-sm text-primary-700 hover:text-primary-800 font-medium flex items-center gap-1">
          <i class="fas fa-times"></i>
          {% trans "Clear all filters" %}
        </a>
        {% endif %}
      </div>

      <form method="get" class="space-y-4">
        <!-- Hidden search query -->
        <input type="hidden" name="q" value="{{ filters.q }}">

        <!-- Filters Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-5 gap-4">
          <!-- Type Filter -->
          <div>
            <label class="block text-xs font-semibold text-slate-700 uppercase tracking-wider mb-2">
              <i class="fas fa-tag mr-1 text-primary-500"></i>
              {% trans "Type" %}
            </label>
            <select name="type" 
                    class="w-full border-2 border-slate-200 rounded-xl px-4 py-3 text-slate-900 
                           bg-white hover:border-primary-300 focus:border-primary-500 focus:ring-2 
                           focus:ring-primary-200 transition-all duration-200 appearance-none
                           bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%236B7280%22%3E%3Cpath%20d%3D%22M4.293%205.293a1%201%200%20011.414%200L8%207.586l2.293-2.293a1%201%200%20111.414%201.414l-3%203a1%201%200%2001-1.414%200l-3-3a1%201%200%20010-1.414z%22%2F%3E%3C%2Fsvg%3E')] 
                           bg-no-repeat bg-[right_1rem_center] bg-[length:16px_16px] cursor-pointer">
              <option value="">{% trans "All Types" %}</option>
              <option value="JOB" {% if filters.type == "JOB" %}selected{% endif %} 
                      class="flex items-center gap-2">
                {% trans "Jobs & Internships" %}
              </option>
              <option value="SCHOLARSHIP" {% if filters.type == "SCHOLARSHIP" %}selected{% endif %}>
                {% trans "Scholarships & Grants" %}
              </option>
              <option value="COURSE" {% if filters.type == "COURSE" %}selected{% endif %}>
                {% trans "Courses & Certifications" %}
              </option>
            </select>
          </div>

          <!-- Country Filter -->
          <div>
            <label class="block text-xs font-semibold text-slate-700 uppercase tracking-wider mb-2">
              <i class="fas fa-globe mr-1 text-primary-500"></i>
              {% trans "Location" %}
            </label>
            <input name="country" value="{{ filters.country }}" 
                   placeholder="{% trans 'Any country' %}"
                   class="w-full border-2 border-slate-200 rounded-xl px-4 py-3 text-slate-900 
                          bg-white placeholder-slate-500 hover:border-primary-300 
                          focus:border-primary-500 focus:ring-2 focus:ring-primary-200 
                          transition-all duration-200">
          </div>

          <!-- Deadline Filter -->
          <div>
            <label class="block text-xs font-semibold text-slate-700 uppercase tracking-wider mb-2">
              <i class="fas fa-clock mr-1 text-primary-500"></i>
              {% trans "Deadline" %}
            </label>
            <select name="deadline" 
                    class="w-full border-2 border-slate-200 rounded-xl px-4 py-3 text-slate-900 
                           bg-white hover:border-primary-300 focus:border-primary-500 focus:ring-2 
                           focus:ring-primary-200 transition-all duration-200 appearance-none
                           bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%236B7280%22%3E%3Cpath%20d%3D%22M4.293%205.293a1%201%200%20011.414%200L8%207.586l2.293-2.293a1%201%200%20111.414%201.414l-3%203a1%201%200%2001-1.414%200l-3-3a1%201%200%20010-1.414z%22%2F%3E%3C%2Fsvg%3E')] 
                           bg-no-repeat bg-[right_1rem_center] bg-[length:16px_16px] cursor-pointer">
              <option value="">{% trans "Any deadline" %}</option>
              <option value="soon" {% if filters.deadline == "soon" %}selected{% endif %}>
                {% trans "Closing soon (7 days)" %}
              </option>
              <option value="week" {% if filters.deadline == "week" %}selected{% endif %}>
                {% trans "Next 7 days" %}
              </option>
              <option value="month" {% if filters.deadline == "month" %}selected{% endif %}>
                {% trans "Next 30 days" %}
              </option>
            </select>
          </div>

          <!-- Remote Filter -->
          <div class="flex items-end">
            <label class="flex items-center gap-3 cursor-pointer group">
              <div class="relative">
                <input type="checkbox" name="remote" value="1" 
                       {% if filters.remote == "1" %}checked{% endif %}
                       class="sr-only peer">
                <div class="w-12 h-6 bg-slate-200 rounded-full peer 
                          peer-checked:bg-primary-600 transition-colors duration-200"></div>
                <div class="absolute left-1 top-1 bg-white w-4 h-4 rounded-full 
                          transition-transform duration-200 peer-checked:translate-x-6"></div>
              </div>
              <div class="select-none">
                <div class="font-medium text-slate-900 group-hover:text-primary-700 transition-colors">
                  {% trans "Remote Only" %}
                </div>
                <div class="text-xs text-slate-500">{% trans "Work from anywhere" %}</div>
              </div>
            </label>
          </div>

          <!-- Apply Filters Button -->
          <div class="flex items-end">
            <button type="submit"
                    class="w-full py-3 px-6 rounded-xl bg-gradient-to-r from-primary-600 to-secondary-600 
                           text-white font-bold hover:from-primary-700 hover:to-secondary-700 
                           hover:shadow-lg transition-all duration-200 flex items-center justify-center gap-2">
              <i class="fas fa-filter"></i>
              {% trans "Apply Filters" %}
            </button>
          </div>
        </div>

        <!-- Active Filters Display -->
        {% if filters_active %}
        <div class="pt-4 border-t border-slate-200">
          <div class="flex flex-wrap items-center gap-2">
            <span class="text-sm text-slate-600">{% trans "Active filters:" %}</span>
            
            {% if filters.type %}
            <span class="inline-flex items-center gap-1 px-3 py-1.5 rounded-full bg-primary-100 text-primary-800 text-sm">
              <i class="fas fa-tag text-xs"></i>
              {{ filters.get_type_display|default:filters.type }}
              <button type="button" onclick="removeFilter('type')" class="ml-1 hover:text-primary-900">
                <i class="fas fa-times text-xs"></i>
              </button>
            </span>
            {% endif %}
            
            {% if filters.country %}
            <span class="inline-flex items-center gap-1 px-3 py-1.5 rounded-full bg-primary-100 text-primary-800 text-sm">
              <i class="fas fa-globe text-xs"></i>
              {{ filters.country }}
              <button type="button" onclick="removeFilter('country')" class="ml-1 hover:text-primary-900">
                <i class="fas fa-times text-xs"></i>
              </button>
            </span>
            {% endif %}
            
            {% if filters.deadline %}
            <span class="inline-flex items-center gap-1 px-3 py-1.5 rounded-full bg-primary-100 text-primary-800 text-sm">
              <i class="fas fa-clock text-xs"></i>
              {{ filters.get_deadline_display|default:filters.deadline }}
              <button type="button" onclick="removeFilter('deadline')" class="ml-1 hover:text-primary-900">
                <i class="fas fa-times text-xs"></i>
              </button>
            </span>
            {% endif %}
            
            {% if filters.remote == "1" %}
            <span class="inline-flex items-center gap-1 px-3 py-1.5 rounded-full bg-primary-100 text-primary-800 text-sm">
              <i class="fas fa-wifi text-xs"></i>
              {% trans "Remote" %}
              <button type="button" onclick="removeFilter('remote')" class="ml-1 hover:text-primary-900">
                <i class="fas fa-times text-xs"></i>
              </button>
            </span>
            {% endif %}
          </div>
        </div>
        {% endif %}
      </form>
    </div>
  </div>
</section>

<!-- Results Section -->
<main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
  {% if items %}
  <!-- Results Grid -->
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    {% for listing in items %}
    <article class="group bg-white rounded-2xl border border-slate-200 shadow-lg hover-card overflow-hidden">
      <!-- Featured Badge -->
      {% if listing.is_featured %}
      <div class="absolute top-4 left-4 z-10">
        <span class="px-3 py-1.5 rounded-full bg-gradient-to-r from-amber-500 to-amber-600 
                     text-white text-xs font-bold shadow-md flex items-center gap-1">
          <i class="fas fa-crown text-xs"></i>
          {% trans "FEATURED" %}
        </span>
      </div>
      {% endif %}
      
      <!-- Image -->
      {% if listing.image %}
      <div class="h-48 overflow-hidden">
        <img src="{{ listing.image.url }}" alt="{{ listing.title }}" 
             class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105">
      </div>
      {% else %}
      <div class="h-48 bg-gradient-to-br 
                  {% if listing.type == 'JOB' %} from-blue-100 to-blue-200
                  {% elif listing.type == 'SCHOLARSHIP' %} from-emerald-100 to-emerald-200
                  {% elif listing.type == 'COURSE' %} from-purple-100 to-purple-200
                  {% else %} from-primary-100 to-secondary-100 {% endif %}
                  flex items-center justify-center">
        <i class="fas 
          {% if listing.type == 'JOB' %} fa-briefcase
          {% elif listing.type == 'SCHOLARSHIP' %} fa-graduation-cap
          {% elif listing.type == 'COURSE' %} fa-book-open
          {% else %} fa-star {% endif %}
          {% if listing.type == 'JOB' %} text-blue-500
          {% elif listing.type == 'SCHOLARSHIP' %} text-emerald-500
          {% elif listing.type == 'COURSE' %} text-purple-500
          {% else %} text-primary-500 {% endif %}
          text-4xl"></i>
      </div>
      {% endif %}
      
      <!-- Content -->
      <div class="p-6">
        <!-- Badges -->
        <div class="flex flex-wrap items-center gap-2 mb-4">
          <span class="px-3 py-1.5 rounded-full text-xs font-semibold 
                      {% if listing.type == 'JOB' %}bg-blue-100 text-blue-800 border border-blue-200
                      {% elif listing.type == 'SCHOLARSHIP' %}bg-emerald-100 text-emerald-800 border border-emerald-200
                      {% elif listing.type == 'COURSE' %}bg-purple-100 text-purple-800 border border-purple-200
                      {% else %}bg-slate-100 text-slate-800 border border-slate-200{% endif %}">
            {{ listing.get_type_display }}
          </span>
          
          {% if listing.remote %}
          <span class="px-3 py-1.5 rounded-full bg-emerald-100 text-emerald-800 
                       text-xs font-semibold border border-emerald-200">
            <i class="fas fa-wifi mr-1"></i> {% trans "Remote" %}
          </span>
          {% endif %}
          
          {% if listing.country %}
          <span class="px-3 py-1.5 rounded-full bg-slate-100 text-slate-700 
                       text-xs font-semibold border border-slate-200 flex items-center gap-1">
            <i class="fas fa-map-marker-alt text-xs"></i>
            {{ listing.country }}
          </span>
          {% endif %}
        </div>
        
        <!-- Title -->
        <a href="{% url 'listing_detail' listing.id %}">
          <h3 class="text-xl font-bold text-slate-900 mb-2 group-hover:text-primary-700 
                     transition-colors line-clamp-2">
            {{ listing.title }}
          </h3>
        </a>
        
        <!-- Organization -->
        {% if listing.organization %}
        <div class="flex items-center gap-2 mb-4">
          <div class="h-6 w-6 rounded-md bg-slate-100 flex items-center justify-center">
            <i class="fas fa-building text-slate-500 text-xs"></i>
          </div>
          <span class="text-sm text-slate-700 truncate">{{ listing.organization }}</span>
        </div>
        {% endif %}
        
        <!-- Description Preview -->
        {% if listing.description %}
        <div class="mb-4">
          <p class="text-sm text-slate-600 line-clamp-2">
            {{ listing.description|striptags|truncatechars:120 }}
          </p>
        </div>
        {% endif %}
        
        <!-- Deadline -->
        <div class="mt-6 pt-5 border-t border-slate-100">
          <div class="flex items-center justify-between">
            <div>
              <div class="text-xs text-slate-500 uppercase font-semibold mb-1">{% trans "Deadline" %}</div>
              <div class="text-sm font-bold text-slate-900">
                {{ listing.deadline|default:_("Rolling")|date:"M d, Y" }}
              </div>
              {% if listing.deadline %}
              <div class="text-xs text-slate-500 mt-1">
                {% trans "in" %} {{ listing.deadline|timeuntil }}
              </div>
              {% endif %}
            </div>
            
            <!-- Action Buttons -->
            <div class="flex items-center gap-2">
              <a href="{% url 'listing_detail' listing.id %}" 
                 class="px-4 py-2 rounded-lg bg-primary-50 text-primary-700 text-sm font-semibold 
                        hover:bg-primary-100 transition-all duration-200 flex items-center gap-2">
                {% trans "View" %}
                <i class="fas fa-arrow-right text-xs"></i>
              </a>
              
              {% if listing.apply_url %}
              <a href="{{ listing.apply_url }}" target="_blank" rel="noopener noreferrer"
                 class="px-4 py-2 rounded-lg bg-gradient-to-r from-primary-600 to-secondary-600 
                        text-white text-sm font-semibold hover:from-primary-700 hover:to-secondary-700 
                        hover:shadow-md transition-all duration-200 flex items-center gap-2">
                {% trans "Apply" %}
                <i class="fas fa-external-link-alt text-xs"></i>
              </a>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
    </article>
    {% endfor %}
  </div>
  
  <!-- Pagination -->
  {% if page_obj and page_obj.paginator.num_pages > 1 %}
  <div class="mt-12 pt-8 border-t border-slate-200">
    <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6">
      <!-- Page Info -->
      <div class="text-sm text-slate-600">
        <span class="font-semibold text-slate-900">{{ page_obj.start_index }}-{{ page_obj.end_index }}</span>
        {% trans "of" %}
        <span class="font-semibold text-slate-900">{{ page_obj.paginator.count }}</span>
        {% trans "results" %}
      </div>
      
      <!-- Pagination Controls -->
      <div class="flex items-center gap-2">
        <!-- Previous Button -->
        {% if page_obj.has_previous %}
        <a href="?{% for key, value in request.GET.items %}{% if key != 'page' %}{{ key }}={{ value|urlencode }}&{% endif %}{% endfor %}page={{ page_obj.previous_page_number }}"
           class="px-4 py-2.5 rounded-xl border border-slate-200 bg-white text-slate-700 
                  font-medium hover:bg-slate-50 hover:border-primary-300 hover:text-primary-700 
                  transition-all duration-200 flex items-center gap-2">
          <i class="fas fa-chevron-left text-xs"></i>
          {% trans "Previous" %}
        </a>
        {% else %}
        <span class="px-4 py-2.5 rounded-xl border border-slate-200 bg-slate-50 
                     text-slate-400 font-medium cursor-not-allowed flex items-center gap-2">
          <i class="fas fa-chevron-left text-xs"></i>
          {% trans "Previous" %}
        </span>
        {% endif %}
        
        <!-- Page Numbers -->
        <div class="hidden sm:flex items-center gap-1">
          {% for num in page_obj.paginator.page_range %}
            {% if num == page_obj.number %}
            <span class="h-10 w-10 rounded-xl bg-gradient-to-r from-primary-600 to-secondary-600 
                         text-white font-bold flex items-center justify-center">
              {{ num }}
            </span>
            {% elif num > page_obj.number|add:"-3" and num < page_obj.number|add:"3" %}
            <a href="?{% for key, value in request.GET.items %}{% if key != 'page' %}{{ key }}={{ value|urlencode }}&{% endif %}{% endfor %}page={{ num }}"
               class="h-10 w-10 rounded-xl border border-slate-200 bg-white text-slate-700 
                      font-medium hover:bg-slate-50 hover:border-primary-300 hover:text-primary-700 
                      transition-all duration-200 flex items-center justify-center">
              {{ num }}
            </a>
            {% endif %}
          {% endfor %}
          
          {% if page_obj.paginator.num_pages > page_obj.number|add:"2" %}
          <span class="px-3 text-slate-400">...</span>
          <a href="?{% for key, value in request.GET.items %}{% if key != 'page' %}{{ key }}={{ value|urlencode }}&{% endif %}{% endfor %}page={{ page_obj.paginator.num_pages }}"
             class="h-10 w-10 rounded-xl border border-slate-200 bg-white text-slate-700 
                    font-medium hover:bg-slate-50 hover:border-primary-300 hover:text-primary-700 
                    transition-all duration-200 flex items-center justify-center">
            {{ page_obj.paginator.num_pages }}
          </a>
          {% endif %}
        </div>
        
        <!-- Next Button -->
        {% if page_obj.has_next %}
        <a href="?{% for key, value in request.GET.items %}{% if key != 'page' %}{{ key }}={{ value|urlencode }}&{% endif %}{% endfor %}page={{ page_obj.next_page_number }}"
           class="px-4 py-2.5 rounded-xl border border-slate-200 bg-white text-slate-700 
                  font-medium hover:bg-slate-50 hover:border-primary-300 hover:text-primary-700 
                  transition-all duration-200 flex items-center gap-2">
          {% trans "Next" %}
          <i class="fas fa-chevron-right text-xs"></i>
        </a>
        {% else %}
        <span class="px-4 py-2.5 rounded-xl border border-slate-200 bg-slate-50 
                     text-slate-400 font-medium cursor-not-allowed flex items-center gap-2">
          {% trans "Next" %}
          <i class="fas fa-chevron-right text-xs"></i>
        </span>
        {% endif %}
      </div>
    </div>
  </div>
  {% endif %}
  
  {% else %}
  <!-- Empty State -->
  <div class="py-16 text-center">
    <div class="max-w-md mx-auto">
      <div class="inline-flex h-24 w-24 rounded-2xl bg-gradient-to-br from-slate-100 to-slate-200 
                  items-center justify-center mb-6">
        <i class="fas fa-search text-slate-400 text-3xl"></i>
      </div>
      
      <h3 class="text-2xl font-bold text-slate-900 mb-3">{% trans "No Opportunities Found" %}</h3>
      
      <p class="text-slate-600 mb-8">
        {% trans "We couldn't find any opportunities matching your filters. Try adjusting your search criteria or browse all opportunities." %}
      </p>
      
      <div class="flex flex-col sm:flex-row gap-3 justify-center">
        <a href="{% url 'listings_list' %}" 
           class="px-6 py-3 rounded-xl bg-gradient-to-r from-primary-600 to-secondary-600 
                  text-white font-semibold hover:from-primary-700 hover:to-secondary-700 
                  hover:shadow-lg transition-all duration-200">
          {% trans "Browse All Opportunities" %}
        </a>
        
        <button onclick="clearAllFilters()"
                class="px-6 py-3 rounded-xl border-2 border-primary-200 bg-white 
                       text-primary-700 font-semibold hover:bg-primary-50 
                       hover:border-primary-300 transition-all duration-200">
          {% trans "Clear All Filters" %}
        </button>
      </div>
      
      <!-- Suggestions -->
      <div class="mt-10 pt-8 border-t border-slate-200">
        <h4 class="text-sm font-semibold text-slate-900 mb-4">{% trans "Suggestions" %}</h4>
        <div class="flex flex-wrap justify-center gap-3">
          <a href="{% url 'listings_list' %}?type=JOB" 
             class="px-4 py-2 rounded-lg border border-slate-200 bg-white 
                    text-slate-700 hover:bg-slate-50 transition-colors">
            {% trans "Browse Jobs" %}
          </a>
          <a href="{% url 'listings_list' %}?type=SCHOLARSHIP" 
             class="px-4 py-2 rounded-lg border border-slate-200 bg-white 
                    text-slate-700 hover:bg-slate-50 transition-colors">
            {% trans "Browse Scholarships" %}
          </a>
          <a href="{% url 'listings_list' %}?type=COURSE" 
             class="px-4 py-2 rounded-lg border border-slate-200 bg-white 
                    text-slate-700 hover:bg-slate-50 transition-colors">
            {% trans "Browse Courses" %}
          </a>
          <a href="{% url 'listings_list' %}?remote=1" 
             class="px-4 py-2 rounded-lg border border-slate-200 bg-white 
                    text-slate-700 hover:bg-slate-50 transition-colors">
            {% trans "Remote Opportunities" %}
          </a>
        </div>
      </div>
    </div>
  </div>
  {% endif %}
</main>

<script>
  // Remove specific filter
  function removeFilter(filterName) {
    const url = new URL(window.location.href);
    url.searchParams.delete(filterName);
    window.location.href = url.toString();
  }
  
  // Clear all filters
  function clearAllFilters() {
    window.location.href = "{% url 'listings_list' %}";
  }
  
  // Initialize filters
  document.addEventListener('DOMContentLoaded', function() {
    // Add animation to cards on scroll
    const observerOptions = {
      threshold: 0.1,
      rootMargin: '0px 0px -50px 0px'
    };
    
    const observer = new IntersectionObserver(function(entries) {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('animate-fade-in');
        }
      });
    }, observerOptions);
    
    // Observe all cards
    document.querySelectorAll('.hover-card').forEach(card => {
      observer.observe(card);
    });
    
    // Auto-submit filters on change
    const filterSelects = document.querySelectorAll('select[name="type"], select[name="deadline"]');
    filterSelects.forEach(select => {
      select.addEventListener('change', function() {
        if (this.value) {
          this.closest('form').submit();
        }
      });
    });
    
    // Toggle remote filter with visual feedback
    const remoteCheckbox = document.querySelector('input[name="remote"]');
    if (remoteCheckbox) {
      remoteCheckbox.addEventListener('change', function() {
        if (this.checked) {
          this.closest('form').submit();
        }
      });
    }
  });
</script>

<style>
  /* Custom styles */
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
  .hover-card {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  .hover-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 20px 40px -12px rgba(0, 0, 0, 0.1);
  }
</style>
{% endblock %}